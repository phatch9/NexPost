import{r as A,d as Fe,b as Le,h as Z,e as R,u as te,j as l,S as q,i as Re,g as Ye,L as Je}from"./index-C5ZQxRwH.js";import{m as Ie,A as Pe}from"./proxy-DXfvcpxa.js";import{P as Xe}from"./PostCurrent-CpKU4QIs.js";function H(){return H=Object.assign?Object.assign.bind():function(o){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var d in s)Object.prototype.hasOwnProperty.call(s,d)&&(o[d]=s[d])}return o},H.apply(this,arguments)}const et=["children","options"],ye=["allowFullScreen","allowTransparency","autoComplete","autoFocus","autoPlay","cellPadding","cellSpacing","charSet","classId","colSpan","contentEditable","contextMenu","crossOrigin","encType","formAction","formEncType","formMethod","formNoValidate","formTarget","frameBorder","hrefLang","inputMode","keyParams","keyType","marginHeight","marginWidth","maxLength","mediaGroup","minLength","noValidate","radioGroup","readOnly","rowSpan","spellCheck","srcDoc","srcLang","srcSet","tabIndex","useMap"].reduce((o,r)=>(o[r.toLowerCase()]=r,o),{class:"className",for:"htmlFor"}),ge={amp:"&",apos:"'",gt:">",lt:"<",nbsp:" ",quot:"“"},tt=["style","script","pre"],nt=["src","href","data","formAction","srcDoc","action"],rt=/([-A-Z0-9_:]+)(?:\s*=\s*(?:(?:"((?:\\.|[^"])*)")|(?:'((?:\\.|[^'])*)')|(?:\{((?:\\.|{[^}]*?}|[^}])*)\})))?/gi,ot=/\n{2,}$/,be=/^(\s*>[\s\S]*?)(?=\n\n|$)/,st=/^ *> ?/gm,it=/^(?:\[!([^\]]*)\]\n)?([\s\S]*)/,lt=/^ {2,}\n/,at=/^(?:([-*_])( *\1){2,}) *(?:\n *)+\n/,ke=/^(?: {1,3})?(`{3,}|~{3,}) *(\S+)? *([^\n]*?)?\n([\s\S]*?)(?:\1\n?|$)/,ve=/^(?: {4}[^\n]+\n*)+(?:\n *)+\n?/,ct=/^(`+)((?:\\`|(?!\1)`|[^`])+)\1/,ut=/^(?:\n *)*\n/,dt=/\r\n?/g,mt=/^\[\^([^\]]+)](:(.*)((\n+ {4,}.*)|(\n(?!\[\^).+))*)/,ft=/^\[\^([^\]]+)]/,pt=/\f/g,ht=/^---[ \t]*\n(.|\n)*\n---[ \t]*\n/,xt=/^\s*?\[(x|\s)\]/,je=/^ *(#{1,6}) *([^\n]+?)(?: +#*)?(?:\n *)*(?:\n|$)/,Ce=/^ *(#{1,6}) +([^\n]+?)(?: +#*)?(?:\n *)*(?:\n|$)/,we=/^([^\n]+)\n *(=|-)\2{2,} *\n/,ie=/^ *(?!<[a-z][^ >/]* ?\/>)<([a-z][^ >/]*) ?((?:[^>]*[^/])?)>\n?(\s*(?:<\1[^>]*?>[\s\S]*?<\/\1>|(?!<\1\b)[\s\S])*?)<\/\1>(?!<\/\1>)\n*/i,yt=/&([a-z0-9]+|#[0-9]{1,6}|#x[0-9a-fA-F]{1,6});/gi,_e=/^<!--[\s\S]*?(?:-->)/,gt=/^(data|aria|x)-[a-z_][a-z\d_.-]*$/,le=/^ *<([a-z][a-z0-9:]*)(?:\s+((?:<.*?>|[^>])*))?\/?>(?!<\/\1>)(\s*\n)?/i,bt=/^\{.*\}$/,kt=/^(https?:\/\/[^\s<]+[^<.,:;"')\]\s])/,vt=/^<([^ >]+[:@\/][^ >]+)>/,jt=/-([a-z])?/gi,Ne=/^(\|.*)\n(?: *(\|? *[-:]+ *\|[-| :]*)\n((?:.*\|.*\n)*))?\n?/,Ct=/^[^\n]+(?:  \n|\n{2,})/,wt=/^\[([^\]]*)\]:\s+<?([^\s>]+)>?\s*("([^"]*)")?/,_t=/^!\[([^\]]*)\] ?\[([^\]]*)\]/,Nt=/^\[([^\]]*)\] ?\[([^\]]*)\]/,St=/(\n|^[-*]\s|^#|^ {2,}|^-{2,}|^>\s)/,$t=/\t/g,At=/(^ *\||\| *$)/g,Mt=/^ *:-+: *$/,Ot=/^ *:-+ *$/,Et=/^ *-+: *$/,ne=o=>`(?=[\\s\\S]+?\\1${o?"\\1":""})`,re="((?:\\[.*?\\][([].*?[)\\]]|<.*?>(?:.*?<.*?>)?|`.*?`|\\\\\\1|[\\s\\S])+?)",Tt=RegExp(`^([*_])\\1${ne(1)}${re}\\1\\1(?!\\1)`),Ft=RegExp(`^([*_])${ne(0)}${re}\\1(?!\\1)`),Lt=RegExp(`^(==)${ne(0)}${re}\\1`),Rt=RegExp(`^(~~)${ne(0)}${re}\\1`),It=/^(:[a-zA-Z0-9-_]+:)/,Pt=/^\\([^0-9A-Za-z\s])/,zt=/\\([^0-9A-Za-z\s])/g,Ut=/^[\s\S](?:(?!  \n|[0-9]\.|http)[^=*_~\-\n:<`\\\[!])*/,Bt=/^\n+/,Ht=/^([ \t]*)/,qt=/(?:^|\n)( *)$/,pe="(?:\\d+\\.)",he="(?:[*+-])";function ze(o){return"( *)("+(o===1?pe:he)+") +"}const Ue=ze(1),Be=ze(2);function He(o){return RegExp("^"+(o===1?Ue:Be))}const Vt=He(1),Dt=He(2);function qe(o){return RegExp("^"+(o===1?Ue:Be)+"[^\\n]*(?:\\n(?!\\1"+(o===1?pe:he)+" )[^\\n]*)*(\\n|$)","gm")}const Qt=qe(1),Wt=qe(2);function Ve(o){const r=o===1?pe:he;return RegExp("^( *)("+r+") [\\s\\S]+?(?:\\n{2,}(?! )(?!\\1"+r+" (?!"+r+" ))\\n*|\\s*\\n*$)")}const De=Ve(1),Qe=Ve(2);function Se(o,r){const s=r===1,d=s?De:Qe,f=s?Qt:Wt,c=s?Vt:Dt;return{t:m=>c.test(m),o:Q(function(m,h){const i=qt.exec(h.prevCapture);return i&&(h.list||!h.inline&&!h.simple)?d.exec(m=i[1]+m):null}),i:1,u(m,h,i){const j=s?+m[2]:void 0,C=m[0].replace(ot,`
`).match(f);let b=!1;return{items:C.map(function(k,w){const v=c.exec(k)[0].length,g=RegExp("^ {1,"+v+"}","gm"),S=k.replace(g,"").replace(c,""),e=w===C.length-1,n=S.indexOf(`

`)!==-1||e&&b;b=n;const t=i.inline,u=i.list;let a;i.list=!0,n?(i.inline=!1,a=G(S)+`

`):(i.inline=!0,a=G(S));const p=h(a,i);return i.inline=t,i.list=u,p}),ordered:s,start:j}},l:(m,h,i)=>o(m.ordered?"ol":"ul",{key:i.key,start:m.type==="20"?m.start:void 0},m.items.map(function(j,C){return o("li",{key:C},h(j,i))}))}}const Zt=RegExp(`^\\[((?:\\[[^\\[\\]]*(?:\\[[^\\[\\]]*\\][^\\[\\]]*)*\\]|[^\\[\\]])*)\\]\\(\\s*<?((?:\\([^)]*\\)|[^\\s\\\\]|\\\\.)*?)>?(?:\\s+['"]([\\s\\S]*?)['"])?\\s*\\)`),Gt=/^!\[(.*?)\]\( *((?:\([^)]*\)|[^() ])*) *"?([^)"]*)?"?\)/;function $e(o){return typeof o=="string"}function G(o){let r=o.length;for(;r>0&&o[r-1]<=" ";)r--;return o.slice(0,r)}function X(o,r){return o.startsWith(r)}function Kt(o,r,s){if(Array.isArray(s)){for(let d=0;d<s.length;d++)if(X(o,s[d]))return!0;return!1}return s(o,r)}function W(o){return o.replace(/[ÀÁÂÃÄÅàáâãäåæÆ]/g,"a").replace(/[çÇ]/g,"c").replace(/[ðÐ]/g,"d").replace(/[ÈÉÊËéèêë]/g,"e").replace(/[ÏïÎîÍíÌì]/g,"i").replace(/[Ññ]/g,"n").replace(/[øØœŒÕõÔôÓóÒò]/g,"o").replace(/[ÜüÛûÚúÙù]/g,"u").replace(/[ŸÿÝý]/g,"y").replace(/[^a-z0-9- ]/gi,"").replace(/ /gi,"-").toLowerCase()}function Yt(o){return Et.test(o)?"right":Mt.test(o)?"center":Ot.test(o)?"left":null}function Ae(o,r,s,d){const f=s.inTable;s.inTable=!0;let c=[[]],m="";function h(){if(!m)return;const i=c[c.length-1];i.push.apply(i,r(m,s)),m=""}return o.trim().split(/(`[^`]*`|\\\||\|)/).filter(Boolean).forEach((i,j,C)=>{i.trim()==="|"&&(h(),d)?j!==0&&j!==C.length-1&&c.push([]):m+=i}),h(),s.inTable=f,c}function Jt(o,r,s){s.inline=!0;const d=o[2]?o[2].replace(At,"").split("|").map(Yt):[],f=o[3]?(function(m,h,i){return m.trim().split(`
`).map(function(j){return Ae(j,h,i,!0)})})(o[3],r,s):[],c=Ae(o[1],r,s,!!f.length);return s.inline=!1,f.length?{align:d,cells:f,header:c,type:"25"}:{children:c,type:"21"}}function Me(o,r){return o.align[r]==null?{}:{textAlign:o.align[r]}}function Q(o){return o.inline=1,o}function B(o){return Q(function(r,s){return s.inline?o.exec(r):null})}function L(o){return Q(function(r,s){return s.inline||s.simple?o.exec(r):null})}function F(o){return function(r,s){return s.inline||s.simple?null:o.exec(r)}}function J(o){return Q(function(r){return o.exec(r)})}const Xt=/(javascript|vbscript|data(?!:image)):/i;function en(o){try{const r=decodeURIComponent(o).replace(/[^A-Za-z0-9/:]/g,"");if(Xt.test(r))return null}catch{return null}return o}function T(o){return o&&o.replace(zt,"$1")}function ee(o,r,s){const d=s.inline||!1,f=s.simple||!1;s.inline=!0,s.simple=!0;const c=o(r,s);return s.inline=d,s.simple=f,c}function tn(o,r,s){const d=s.inline||!1,f=s.simple||!1;s.inline=!1,s.simple=!0;const c=o(r,s);return s.inline=d,s.simple=f,c}function nn(o,r,s){const d=s.inline||!1;s.inline=!1;const f=o(r,s);return s.inline=d,f}const ae=(o,r,s)=>({children:ee(r,o[2],s)});function ce(){return{}}function ue(){return null}function rn(...o){return o.filter(Boolean).join(" ")}function de(o,r,s){let d=o;const f=r.split(".");for(;f.length&&(d=d[f[0]],d!==void 0);)f.shift();return d||s}function on(o="",r={}){r.overrides=r.overrides||{},r.namedCodesToUnicode=r.namedCodesToUnicode?H({},ge,r.namedCodesToUnicode):ge;const s=r.slugify||W,d=r.sanitizer||en,f=r.createElement||A.createElement,c=[be,ke,ve,r.enforceAtxHeadings?Ce:je,we,Ne,De,Qe],m=[...c,Ct,ie,_e,le];function h(e,n){for(let t=0;t<e.length;t++)if(e[t].test(n))return!0;return!1}function i(e,n,...t){const u=de(r.overrides,e+".props",{});return f((function(a,p){const x=de(p,a);return x?typeof x=="function"||typeof x=="object"&&"render"in x?x:de(p,a+".component",a):a})(e,r.overrides),H({},n,u,{className:rn(n?.className,u.className)||void 0}),...t)}function j(e){e=e.replace(ht,"");let n=!1;r.forceInline?n=!0:r.forceBlock||(n=St.test(e)===!1);const t=g(v(n?e:G(e).replace(Bt,"")+`

`,{inline:n}));for(;$e(t[t.length-1])&&!t[t.length-1].trim();)t.pop();if(r.wrapper===null)return t;const u=r.wrapper||(n?"span":"div");let a;if(t.length>1||r.forceWrapper)a=t;else{if(t.length===1)return a=t[0],typeof a=="string"?i("span",{key:"outer"},a):a;a=null}return f(u,{key:"outer"},a)}function C(e,n){if(!n||!n.trim())return null;const t=n.match(rt);return t?t.reduce(function(u,a){const p=a.indexOf("=");if(p!==-1){const x=(function(_){return _.indexOf("-")!==-1&&_.match(gt)===null&&(_=_.replace(jt,function(O,M){return M.toUpperCase()})),_})(a.slice(0,p)).trim(),y=(function(_){const O=_[0];return(O==='"'||O==="'")&&_.length>=2&&_[_.length-1]===O?_.slice(1,-1):_})(a.slice(p+1).trim()),N=ye[x]||x;if(N==="ref")return u;const $=u[N]=(function(_,O,M,xe){return O==="style"?(function(V){const I=[];let P="",z=!1,K=!1,oe="";if(!V)return I;for(let U=0;U<V.length;U++){const E=V[U];if(E!=='"'&&E!=="'"||z||(K?E===oe&&(K=!1,oe=""):(K=!0,oe=E)),E==="("&&P.endsWith("url")?z=!0:E===")"&&z&&(z=!1),E!==";"||K||z)P+=E;else{const D=P.trim();if(D){const se=D.indexOf(":");if(se>0){const Ge=D.slice(0,se).trim(),Ke=D.slice(se+1).trim();I.push([Ge,Ke])}}P=""}}const Y=P.trim();if(Y){const U=Y.indexOf(":");if(U>0){const E=Y.slice(0,U).trim(),D=Y.slice(U+1).trim();I.push([E,D])}}return I})(M).reduce(function(V,[I,P]){return V[I.replace(/(-[a-z])/g,z=>z[1].toUpperCase())]=xe(P,_,I),V},{}):nt.indexOf(O)!==-1?xe(T(M),_,O):(M.match(bt)&&(M=T(M.slice(1,M.length-1))),M==="true"||M!=="false"&&M)})(e,x,y,d);typeof $=="string"&&(ie.test($)||le.test($))&&(u[N]=j($.trim()))}else a!=="style"&&(u[ye[a]||a]=!0);return u},{}):null}const b=[],k={},w={0:{t:[">"],o:F(be),i:1,u(e,n,t){const[,u,a]=e[0].replace(st,"").match(it);return{alert:u,children:n(a,t)}},l(e,n,t){const u={key:t.key};return e.alert&&(u.className="markdown-alert-"+s(e.alert.toLowerCase(),W),e.children.unshift({attrs:{},children:[{type:"27",text:e.alert}],noInnerParse:!0,type:"11",tag:"header"})),i("blockquote",u,n(e.children,t))}},1:{t:["  "],o:J(lt),i:1,u:ce,l:(e,n,t)=>i("br",{key:t.key})},2:{t:["--","__","**","- ","* ","_ "],o:F(at),i:1,u:ce,l:(e,n,t)=>i("hr",{key:t.key})},3:{t:["    "],o:F(ve),i:0,u:e=>({lang:void 0,text:T(G(e[0].replace(/^ {4}/gm,"")))}),l:(e,n,t)=>i("pre",{key:t.key},i("code",H({},e.attrs,{className:e.lang?"lang-"+e.lang:""}),e.text))},4:{t:["```","~~~"],o:F(ke),i:0,u:e=>({attrs:C("code",e[3]||""),lang:e[2]||void 0,text:e[4],type:"3"})},5:{t:["`"],o:L(ct),i:3,u:e=>({text:T(e[2])}),l:(e,n,t)=>i("code",{key:t.key},e.text)},6:{t:["[^"],o:F(mt),i:0,u:e=>(b.push({footnote:e[2],identifier:e[1]}),{}),l:ue},7:{t:["[^"],o:B(ft),i:1,u:e=>({target:"#"+s(e[1],W),text:e[1]}),l:(e,n,t)=>i("a",{key:t.key,href:d(e.target,"a","href")},i("sup",{key:t.key},e.text))},8:{t:["[ ]","[x]"],o:B(xt),i:1,u:e=>({completed:e[1].toLowerCase()==="x"}),l:(e,n,t)=>i("input",{checked:e.completed,key:t.key,readOnly:!0,type:"checkbox"})},9:{t:["#"],o:F(r.enforceAtxHeadings?Ce:je),i:1,u:(e,n,t)=>({children:ee(n,e[2],t),id:s(e[2],W),level:e[1].length}),l:(e,n,t)=>i("h"+e.level,{id:e.id,key:t.key},n(e.children,t))},10:{t:e=>{const n=e.indexOf(`
`);return n>0&&n<e.length-1&&(e[n+1]==="="||e[n+1]==="-")},o:F(we),i:0,u:(e,n,t)=>({children:ee(n,e[1],t),level:e[2]==="="?1:2,type:"9"})},11:{t:["<"],o:J(ie),i:1,u(e,n,t){const[,u]=e[3].match(Ht),a=RegExp("^"+u,"gm"),p=e[3].replace(a,""),x=h(m,p)?nn:ee,y=e[1].toLowerCase(),N=tt.indexOf(y)!==-1,$=(N?y:e[1]).trim(),_={attrs:C($,e[2]),noInnerParse:N,tag:$};if(t.inAnchor=t.inAnchor||y==="a",N)_.text=e[3];else{const O=t.inHTML;t.inHTML=!0,_.children=x(n,p,t),t.inHTML=O}return t.inAnchor=!1,_},l:(e,n,t)=>i(e.tag,H({key:t.key},e.attrs),e.text||(e.children?n(e.children,t):""))},13:{t:["<"],o:J(le),i:1,u(e){const n=e[1].trim();return{attrs:C(n,e[2]||""),tag:n}},l:(e,n,t)=>i(e.tag,H({},e.attrs,{key:t.key}))},12:{t:["<!--"],o:J(_e),i:1,u:()=>({}),l:ue},14:{t:["!["],o:L(Gt),i:1,u:e=>({alt:T(e[1]),target:T(e[2]),title:T(e[3])}),l:(e,n,t)=>i("img",{key:t.key,alt:e.alt||void 0,title:e.title||void 0,src:d(e.target,"img","src")})},15:{t:["["],o:B(Zt),i:3,u:(e,n,t)=>({children:tn(n,e[1],t),target:T(e[2]),title:T(e[3])}),l:(e,n,t)=>i("a",{key:t.key,href:d(e.target,"a","href"),title:e.title},n(e.children,t))},16:{t:["<"],o:B(vt),i:0,u(e){let n=e[1],t=!1;return n.indexOf("@")!==-1&&n.indexOf("//")===-1&&(t=!0,n=n.replace("mailto:","")),{children:[{text:n,type:"27"}],target:t?"mailto:"+n:n,type:"15"}}},17:{t:(e,n)=>!n.inAnchor&&!r.disableAutoLink&&(X(e,"http://")||X(e,"https://")),o:B(kt),i:0,u:e=>({children:[{text:e[1],type:"27"}],target:e[1],title:void 0,type:"15"})},20:Se(i,1),33:Se(i,2),19:{t:[`
`],o:F(ut),i:3,u:ce,l:()=>`
`},21:{o:Q(function(e,n){if(n.inline||n.simple||n.inHTML&&e.indexOf(`

`)===-1&&n.prevCapture.indexOf(`

`)===-1)return null;let t="",u=0;for(;;){const p=e.indexOf(`
`,u),x=e.slice(u,p===-1?void 0:p+1);if(h(c,x)||(t+=x,p===-1||!x.trim()))break;u=p+1}const a=G(t);return a===""?null:[t,,a]}),i:3,u:ae,l:(e,n,t)=>i("p",{key:t.key},n(e.children,t))},22:{t:["["],o:B(wt),i:0,u:e=>(k[e[1]]={target:e[2],title:e[4]},{}),l:ue},23:{t:["!["],o:L(_t),i:0,u:e=>({alt:e[1]?T(e[1]):void 0,ref:e[2]}),l:(e,n,t)=>k[e.ref]?i("img",{key:t.key,alt:e.alt,src:d(k[e.ref].target,"img","src"),title:k[e.ref].title}):null},24:{t:e=>e[0]==="["&&e.indexOf("](")===-1,o:B(Nt),i:0,u:(e,n,t)=>({children:n(e[1],t),fallbackChildren:e[0],ref:e[2]}),l:(e,n,t)=>k[e.ref]?i("a",{key:t.key,href:d(k[e.ref].target,"a","href"),title:k[e.ref].title},n(e.children,t)):i("span",{key:t.key},e.fallbackChildren)},25:{t:["|"],o:F(Ne),i:1,u:Jt,l(e,n,t){const u=e;return i("table",{key:t.key},i("thead",null,i("tr",null,u.header.map(function(a,p){return i("th",{key:p,style:Me(u,p)},n(a,t))}))),i("tbody",null,u.cells.map(function(a,p){return i("tr",{key:p},a.map(function(x,y){return i("td",{key:y,style:Me(u,y)},n(x,t))}))})))}},27:{o:Q(function(e,n){let t;return X(e,":")&&(t=It.exec(e)),t||Ut.exec(e)}),i:4,u(e){const n=e[0];return{text:n.indexOf("&")===-1?n:n.replace(yt,(t,u)=>r.namedCodesToUnicode[u]||t)}},l:e=>e.text},28:{t:["**","__"],o:L(Tt),i:2,u:(e,n,t)=>({children:n(e[2],t)}),l:(e,n,t)=>i("strong",{key:t.key},n(e.children,t))},29:{t:e=>{const n=e[0];return(n==="*"||n==="_")&&e[1]!==n},o:L(Ft),i:3,u:(e,n,t)=>({children:n(e[2],t)}),l:(e,n,t)=>i("em",{key:t.key},n(e.children,t))},30:{t:["\\"],o:L(Pt),i:1,u:e=>({text:e[1],type:"27"})},31:{t:["=="],o:L(Lt),i:3,u:ae,l:(e,n,t)=>i("mark",{key:t.key},n(e.children,t))},32:{t:["~~"],o:L(Rt),i:3,u:ae,l:(e,n,t)=>i("del",{key:t.key},n(e.children,t))}};r.disableParsingRawHTML===!0&&(delete w[11],delete w[13]);const v=(function(e){var n=Object.keys(e);function t(u,a){var p=[];if(a.prevCapture=a.prevCapture||"",u.trim())for(;u;)for(var x=0;x<n.length;){var y=n[x],N=e[y];if(!N.t||Kt(u,a,N.t)){var $=N.o(u,a);if($&&$[0]){u=u.substring($[0].length);var _=N.u($,t,a);a.prevCapture+=$[0],_.type||(_.type=y),p.push(_);break}x++}else x++}return a.prevCapture="",p}return n.sort(function(u,a){return e[u].i-e[a].i||(u<a?-1:1)}),function(u,a){return t((function(p){return p.replace(dt,`
`).replace(pt,"").replace($t,"    ")})(u),a)}})(w),g=(function(e,n){return function t(u,a={}){if(Array.isArray(u)){const p=a.key,x=[];let y=!1;for(let N=0;N<u.length;N++){a.key=N;const $=t(u[N],a),_=$e($);_&&y?x[x.length-1]+=$:$!==null&&x.push($),y=_}return a.key=p,x}return(function(p,x,y){const N=e[p.type].l;return n?n(()=>N(p,x,y),p,x,y):N(p,x,y)})(u,t,a)}})(w,r.renderRule),S=j(o);return b.length?i("div",null,S,i("footer",{key:"footer"},b.map(function(e){return i("div",{id:s(e.identifier,W),key:e.identifier},e.identifier,g(v(e.footnote,{inline:!0})))}))):S}const We=o=>{let{children:r="",options:s}=o,d=(function(f,c){if(f==null)return{};var m,h,i={},j=Object.keys(f);for(h=0;h<j.length;h++)c.indexOf(m=j[h])>=0||(i[m]=f[m]);return i})(o,et);return A.cloneElement(on(r,s),d)},Oe=["border-yellow-400","border-blue-400","border-purple-400","border-green-400","border-sky-400","border-pink-400"];let me=0;function sn({children:o,comment:r}){const s=Fe(),{postId:d}=Le(),[f,c]=A.useState(o||[]),[{comment_info:m,user_info:h,current_user:i},j]=A.useState(r),{mutate:C}=Z({mutationFn:async v=>{if(v.length===0)return;const g=await R.post("/api/comments",{post_id:d,content:v,has_parent:!0,parent_id:m.id},{headers:{"Content-Type":"application/json"}});c(S=>[...S,g.data.new_comment])}}),{mutate:b}=Z({mutationFn:async(v=null)=>{console.warn("Using placeholder for confirmation. Implement custom modal UI for production.");try{await R.delete(`/api/comments/${v||m.id}`),v?c(g=>g.filter(S=>S.comment.comment_info.id!==v)):s.setQueryData(["post/comment",d],g=>g&&{...g,comment_info:g.comment_info.filter(S=>S.comment.comment_info.id!==m.id)})}catch(g){console.error("Failed to delete comment:",g)}}}),{mutate:k}=Z({mutationFn:async v=>{v.length!==0&&(await R.patch(`/api/comments/${m.id}`,{content:v}),j(g=>({user_info:g.user_info,current_user:g.current_user,comment_info:{...g.comment_info,content:v,is_edited:!0}})))}});function w(){return me>=Oe.length&&(me=0),Oe[me++]}return{commentChildren:f,commentInfo:m,userInfo:h,currentUser:i,addComment:C,deleteComment:b,updateComment:k,colorSquence:w}}function ln(o){const r=Math.floor((new Date-o)/1e3);let s=Math.floor(r/31536e3);return s>1?s+" years ago":(s=Math.floor(r/2592e3),s>1?s+" months ago":(s=Math.floor(r/86400),s>1?s+" days ago":(s=Math.floor(r/3600),s>1?s+" hours ago":(s=Math.floor(r/60),s>1?s+" minutes ago":r<10?"just now":Math.floor(r)+" seconds ago"))))}const an=({url:o,initialVote:r,initialCount:s,contentID:d,type:f})=>{const[c,m]=A.useState(r),[h,i]=A.useState(s),{isAuthenticated:j}=te(),{mutate:C}=Z({mutationFn:async({vote:w,method:v,contentID:g})=>{const S=`${o}/${g}`;switch(v){case"put":return R.put(S,{is_upvote:w});case"patch":return R.patch(S,{is_upvote:w});case"delete":return R.delete(S);default:return Promise.resolve()}}});function b(w){if(!j){console.error("Authentication Required: You must be logged in to vote.");return}let v,g=0;c===null?(v="put",g=w?1:-1):w===null?(v="delete",g=c?-1:1):(v="patch",g=w?2:-2),i(S=>S+g),m(w),C({vote:w,method:v,contentID:d})}const k=c===!0?"text-theme-red-coral":c===!1?"text-sky-600":"";return f==="mobile"?l.jsxs(l.Fragment,{children:[l.jsx(q,{type:"mobileVote",className:"w-5 h-5 md:w-6 md:h-6",defaultStyle:!0,active:c===!0,onClick:()=>b(c?null:!0)}),l.jsx("p",{className:k,children:h}),l.jsx(q,{type:"mobileVote",className:"w-5 h-5 rotate-180 md:w-6 md:h-6",defaultStyle:!1,active:c===!1,onClick:()=>b(c===!1?null:!1)})]}):l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"px-5 py-0.5 bg-orange-100 rounded-md",children:l.jsx(q,{type:"down-arrow",defaultStyle:!0,className:"w-10 h-10 rotate-180",onClick:()=>b(c?null:!0),active:c===!0})}),l.jsx("p",{className:"text-lg font-semibold",children:l.jsx("span",{className:k,children:h})}),l.jsx("div",{className:"px-5 py-0.5 bg-blue-50 rounded-md group",children:l.jsx(q,{type:"down-arrow",className:"w-10 h-10",defaultStyle:!1,onClick:()=>b(c===!1?null:!1),active:c===!1})})]})};function Ee(o){navigator.clipboard&&window.isSecureContext?navigator.clipboard.writeText(o).then(()=>{console.log("Link Copied to Clipboard")},r=>{console.warn("Clipboard write failed, using fallback:",r),Te(o)}):Te(o)}function Te(o){const r=document.createElement("textarea");r.value=o,r.style.top="0",r.style.left="0",r.style.position="fixed",document.body.appendChild(r),r.focus(),r.select();try{document.execCommand("copy")?console.log("Link Copied to Clipboard (fallback)"):console.error("Fallback: Copying text was unsuccessful")}catch(s){console.error("Fallback: Oops, unable to copy",s)}document.body.removeChild(r)}const Ze=({children:o,comment:r,threadID:s,commentIndex:d,parentDelete:f=null})=>{const c=A.useRef(null),[m,h]=A.useState(!1),[i,j]=A.useState(!1),[C,b]=A.useState(!0),{commentChildren:k,commentInfo:w,userInfo:v,currentUser:g,addComment:S,deleteComment:e,updateComment:n,colorSquence:t}=sn({children:o,comment:r}),{isAuthenticated:u,user:a}=te(),p=ln(new Date(w.created_at));function x(y){switch(y){case"delete":f?f(w.id):e(w.id),c.current&&(c.current.value="more");break;case"edit":j(!0);break;case"share":Ee(window.location.href),c.current&&(c.current.value="more");break}}return l.jsxs(Ie.li,{className:`py-3 pl-2 space-y-2 w-full bg-white rounded-xl md:text-base ${!f&&"border"}`,initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.25,delay:d*.15},exit:{opacity:0,y:-10,transition:{duration:.1}},children:[i?l.jsx(fe,{callBackSubmit:y=>{n(y),j(!1),c.current&&(c.current.value="more")},callBackCancel:()=>{j(!1),c.current&&(c.current.value="more")},defaultValue:w.content,user:a}):l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"flex items-center space-x-2 text-sm font-medium",children:[l.jsx("img",{loading:"lazy",width:"20",height:"20",alt:"",className:"object-cover w-5 h-5 rounded-full"}),l.jsx(Re,{to:`/u/${v.username}`,className:"font-medium text-blue-600 hover:underline",children:v.username}),l.jsx("p",{children:p}),w.is_edited&&l.jsx("p",{children:"(Edited)"})]}),l.jsx("div",{className:"max-w-full text-black prose prose-sm md:prose-base prose-blue",children:l.jsx(We,{className:"[&>*:first-child]:mt-0",children:w.content})})]}),l.jsxs("div",{className:"flex justify-around items-center md:justify-between md:mx-10",children:[u&&a&&(a.username===v.username||a.mod_in.includes(s)||a.roles.includes("admin"))?l.jsxs("select",{defaultValue:"more",ref:c,name:"more-options",title:"More Options",id:"more-options",className:"text-sm bg-white md:px-2 md:text-base",onChange:y=>x(y.target.value),children:[l.jsx("option",{value:"more",children:"More"}),l.jsx("option",{value:"share",children:"Share"}),a.username===v.username&&l.jsx("option",{value:"edit",children:"Edit"}),l.jsx("option",{value:"delete",children:"Delete"})]}):l.jsxs("div",{className:"flex items-center space-x-1 cursor-pointer",onClick:()=>Ee(window.location.href),children:[l.jsx(q,{type:"share",className:"w-4 h-4"}),l.jsx("p",{className:"text-sm md:text-base",children:"Share"})]}),l.jsxs("div",{className:"flex items-center space-x-1 cursor-pointer",onClick:()=>{u?h(!m):console.error("User must be logged in to reply.")},children:[l.jsx(q,{type:"comment",className:"w-4 h-4"}),l.jsx("p",{className:"text-sm md:text-base",children:"Reply"})]}),l.jsxs("div",{className:`${!k.length&&"invisible"} flex items-center space-x-1 cursor-pointer`,onClick:()=>b(!C),children:[l.jsx(q,{type:"down-arrow",className:`w-4 h-4 transition-transform ${C&&"rotate-180"}`}),l.jsx("p",{className:"text-sm md:text-base",children:C?"Hide":"Show"})]}),l.jsx("div",{className:"flex items-center space-x-2 text-sm md:text-base",children:l.jsx(an,{url:"/api/reactions/comment",initialVote:g?.has_upvoted,initialCount:w.comment_karma,contentID:w.id,type:"mobile"})})]}),m&&l.jsx(fe,{callBackSubmit:y=>{c.current&&(c.current.value="more"),S(y),h(!1),b(!0)},callBackCancel:()=>{h(!1),c.current&&(c.current.value="more")},colorSquence:t,user:a}),l.jsx(Pe,{mode:"wait",children:C&&l.jsx("ul",{className:k.length>0&&C?"border-l-2 "+t():"",children:k.map((y,N)=>l.jsx(Ze,{children:y.children,comment:y,commentIndex:N,parentDelete:e,threadID:s},y.comment.comment_info.id))})})]})},fe=({user:o,colorSquence:r,callBackSubmit:s,callBackCancel:d,defaultValue:f=null})=>{const{isAuthenticated:c}=te(),[m,h]=A.useState(!1),[i,j]=A.useState(f||"");return l.jsxs(Ie.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10,transition:{duration:.15}},transition:{duration:.25},className:`mr-4 space-y-2 bg-white md:text-base ${f!==null?"":`border-l-2 ${r?r():"border-gray-200"} py-3 pl-2 `}`,children:[l.jsxs("div",{className:"flex items-center space-x-2 text-sm font-medium",children:[l.jsx("img",{src:o.avatar?o.avatar:avatar,alt:"",className:"object-cover w-5 h-5 rounded-full"}),l.jsx(Re,{to:`/u/${o.username}`,children:o.username})]}),l.jsxs("form",{method:"post",className:"flex flex-col space-y-2",onSubmit:C=>{C.preventDefault(),c?s(i):console.error("User must be logged in to share the comment.")},children:[m?l.jsx("div",{className:"overflow-auto p-2 max-w-full h-24 rounded-md border prose",children:l.jsx(We,{options:{forceBlock:!0},children:i.replace(/\n/g,`<br />
`)||"This is markdown preview"})}):l.jsx("textarea",{autoFocus:!0,value:i,onChange:C=>j(C.target.value),className:"p-2 w-full h-24 text-sm rounded-md border md:text-base focus:outline-none"}),l.jsxs("div",{className:"flex self-end space-x-2",children:[l.jsx("button",{type:"submit",className:"px-2 py-1 font-bold text-white bg-blue-600 rounded-md md:px-5 active:scale-95",children:"Submit"}),l.jsx("button",{onClick:()=>h(!m),type:"button",className:"px-2 py-1 font-bold text-white bg-green-600 rounded-md md:px-5 active:scale-95",children:m?"Close Preview":"Preview"}),l.jsx("button",{onClick:()=>d(),type:"button",className:"px-2 py-1 font-bold text-white bg-red-600 rounded-md md:px-5 active:scale-95",children:"Cancel"})]})]})]})},mn=()=>{const o=Fe(),{user:r,isAuthenticated:s}=te(),{postId:d}=Le(),[f,c]=A.useState(!1),{data:m,isFetching:h,isError:i}=Ye({queryKey:["post/comment",d],queryFn:async()=>await R.get(`/api/posts/${d}/comments`).then(b=>b.data),enabled:!!d}),{mutate:j,isPending:C}=Z({mutationFn:async b=>await R.post("/api/comments",{post_id:d,content:b}).then(k=>k.data),onSuccess:b=>{o.setQueryData(["post/comment",d],k=>{if(k)return{...k,comment_info:[...k.comment_info,b.new_comment]}}),c(!1)},onError:b=>{console.error("Failed to post comment:",b)}});return h?l.jsx("div",{className:"flex flex-col justify-center items-center w-full h-screen",children:l.jsx(Je,{forPosts:!1})}):i||!m?l.jsx("div",{className:"flex flex-col p-2 space-y-2 w-full",children:l.jsx("p",{className:"p-5 text-lg bg-white rounded-xl border-2 hover:shadow-sm border-theme-gray-blue",children:"Sorry, this post could not be loaded."})}):l.jsxs("div",{className:"flex flex-col p-2 space-y-2 w-full",children:[l.jsx("ul",{children:l.jsx(Xe,{post:m.post_info,isExpanded:!0,setCommentMode:c,postIndex:0})}),f&&s&&r&&l.jsx("div",{className:"py-3 pl-2 space-y-2 w-full bg-white rounded-xl md:text-base",children:l.jsx(fe,{user:r,defaultValue:"",callBackSubmit:j,callBackCancel:()=>c(!1),isSubmitting:C})}),m.comment_info.length>0?l.jsx("ul",{className:"space-y-2 rounded-xl md:border-2 md:p-2 hover:shadow-sm border-theme-gray-blue",children:l.jsx(Pe,{children:m.comment_info.map((b,k)=>l.jsx(Ze,{...b,commentIndex:k,threadID:m.post_info.post_info.subthread_id},b.comment.comment_info.id))})}):l.jsx("div",{children:l.jsx("p",{className:"p-5 text-sm bg-white rounded-xl border-2 md:text-base hover:shadow-sm border-theme-gray-blue",children:"This post has no comments, be the first to reply!"})})]})};export{mn as FullPost,mn as default};
