import{r as m,j as e}from"./index-C5ZQxRwH.js";const y=({to:t,children:s,className:o,onClick:r})=>e.jsx("a",{href:t,className:o,onClick:r,children:s}),v=({url:t})=>e.jsxs("div",{className:"bg-black text-white p-4 text-center",children:["Video: ",t]}),N=({children:t,className:s})=>e.jsx("div",{className:s,children:t}),x=({type:t,className:s,onClick:o})=>e.jsxs("span",{className:`inline-block ${s} text-gray-500`,onClick:o,children:["[",t,"]"]}),b=({initialCount:t,type:s})=>e.jsxs("div",{className:`flex items-center ${s==="compact"?"space-x-1":"flex-col"}`,children:[e.jsx(x,{type:"upvote",className:"w-5 h-5 text-gray-400",onClick:()=>{}}),e.jsx("span",{className:"text-sm font-bold",children:t||0}),e.jsx(x,{type:"downvote",className:"w-5 h-5 text-gray-400",onClick:()=>{}})]}),k=({creatorInfo:t,PostInfo:s,currentUser:o,postInfo:r,setShowModal:u,setModalData:f,handleShare:i})=>{const{user:c}={user:{username:"mockuser",roles:["user"],mod_in:[]}},[l,n]=m.useState(!1),d=t?.user_name===c.username,p=d||c.roles.includes("mod")&&c.mod_in.includes(r?.post_id),h=()=>{n(!1)},j=()=>{n(!1),u(!0),f(e.jsx("div",{className:"p-4",children:"Confirm Delete (auth required)"}))};return e.jsxs("div",{className:"relative flex items-center p-1 cursor-pointer select-none",children:[e.jsx(x,{className:"w-6 h-6 text-gray-500",type:"more",onClick:()=>n(a=>!a)}),l&&e.jsxs("ul",{className:"absolute top-full right-0 z-20 p-2 mt-2 space-y-1 w-36 list-none bg-white rounded-lg shadow-xl border border-gray-200",children:[e.jsx("li",{className:"p-1 text-sm text-gray-700 hover:bg-gray-100",onClick:h,children:r?.currentUser?.saved?"Unsave":"Save"}),e.jsx("li",{className:"p-1 text-sm text-gray-700 hover:bg-gray-100",onClick:()=>{i(),n(!1)},children:"Share"}),d&&e.jsx("li",{className:"p-1 text-sm text-gray-700 hover:bg-gray-100",onClick:()=>n(!1),children:"Edit"}),p&&e.jsx("li",{className:"p-1 text-sm text-red-600 hover:bg-red-50",onClick:j,children:"Delete"})]})]})},C=t=>{try{if(navigator&&navigator.clipboard&&navigator.clipboard.writeText)return navigator.clipboard.writeText(t),!0}catch{}const s=document.createElement("textarea");s.value=t,document.body.appendChild(s),s.select();try{return document.execCommand("copy"),document.body.removeChild(s),!0}catch{return document.body.removeChild(s),!1}};function _({post:t={},isExpanded:s=!1,postIndex:o=0,setCommentMode:r=u=>{}}){const u=m.useRef(null),[f,i]=m.useState(!1),[c,l]=m.useState(null),n=t?.post_info?.title;m.useEffect(()=>(s&&(document.title=n||"NexPost Post"),()=>{s&&(document.title="NexPost")}),[s,n]);function d(a){t?.post_info?.media&&(i(!0),l(a==="video"?e.jsx(v,{url:t.post_info.media}):e.jsx("img",{src:t.post_info.media,alt:"post media",className:"rounded"})))}function p(){r(a=>!a)}async function h(){const a=`${window.location.origin}/post/${t?.post_info?.id}`,g=C(a);i(!0),l(e.jsx("div",{className:`p-4 rounded ${g?"bg-green-100":"bg-red-100"}`,children:g?"Copied link":"Could not copy link"})),setTimeout(()=>i(!1),2e3)}const j=new Date(t?.post_info?.created_at||Date.now());return e.jsxs("article",{className:"p-4 mb-4 bg-white rounded shadow",children:[e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(b,{initialCount:t?.post_info?.votes,type:"compact"})}),e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-semibold",children:e.jsx(y,{to:`/post/${t?.post_info?.id}`,children:t?.post_info?.title||"Untitled"})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-xs text-gray-500",children:j.toLocaleString()}),e.jsx(k,{creatorInfo:t?.creator,threadInfo:t?.thread,currentUser:{},postInfo:t,setShowModal:i,setModalData:l,handleShare:h})]})]}),t?.post_info?.media&&e.jsx("div",{className:"mt-3",children:t.post_info.media_type==="video"?e.jsx("div",{className:"cursor-pointer",onClick:()=>d("video"),ref:u,children:e.jsx(v,{url:t.post_info.media})}):e.jsx("img",{src:t.post_info.media,alt:"post media",className:"w-full h-auto rounded-md cursor-pointer",onClick:()=>d("image")})}),t?.post_info?.content&&e.jsx("div",{className:"mt-3 text-sm text-gray-800",children:e.jsx(N,{className:"prose",children:t.post_info.content})}),e.jsxs("div",{className:"mt-3 flex items-center space-x-4",children:[e.jsxs("button",{className:"text-sm text-gray-600",onClick:p,children:[e.jsx(x,{type:"comment",className:"inline mr-1",onClick:()=>{}})," Reply"]}),e.jsxs("button",{className:"text-sm text-gray-600",onClick:h,children:[e.jsx(x,{type:"share",className:"inline mr-1",onClick:()=>{}})," Share"]})]})]})]}),f&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",onClick:()=>i(!1),children:e.jsx("div",{className:"bg-white p-4 rounded",onClick:a=>a.stopPropagation(),children:c})})]})}export{_ as P};
